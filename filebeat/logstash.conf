  input {
    beats {
    port => 5000  # 与Filebeat输出端口一致
    }
  }
    
    filter {
    # 仅处理来自auditor的日志（可选）
    if "auditor-logs" in [tags] {
    # 已在Filebeat中解析JSON，这里可添加额外过滤
    date {
    match => ["ts", "UNIX"]  # 解析日志中的ts字段（Unix时间戳）
    target => "@timestamp"   # 替换Logstash默认时间戳
    }
    }
  }
    
    output {
      elasticsearch {
        hosts => ["elasticsearch:9200"]
        user => "logstash_writer"
        password => "changeme123"
        index => "auditor-logs-%{+YYYY.MM.dd}"
        ssl => false  # 强制使用 HTTP 连接（因 ES 关闭了 http.ssl）# 按日期生成索引
    }
    # 调试输出到控制台（可选）
    stdout {
    codec => rubydebug
    }
  }